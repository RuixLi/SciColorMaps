function map = berlin(m)
%   BERLIN a scientific colour map 6 by FabioCrameri et al.
%   berlin(M) returns an M-by-3 matrix containing a colormap. 
%   written by Ruix.Li in Jan, 2021

% USAGE:
% colormap(berlin(128))
% colormap berlin

if nargin < 1
   f = get(groot,'CurrentFigure');
   if isempty(f)
      m = size(get(groot,'DefaultFigureColormap'),1);
   else
      m = size(f.Colormap,1);
   end
end

values = [
   0.621082002346002   0.690181819089187   0.999506660505566
   0.612157336574861   0.689227785182664   0.995374289614011
   0.603201836621059   0.688249683431223   0.991239305513445
   0.594200227357724   0.687256652433923   0.987091609283106
   0.585165246411653   0.686248095941099   0.982922160333154
   0.576087732961070   0.685222292139570   0.978733431795614
   0.566961034756040   0.684165962185427   0.974524375780994
   0.557791155535974   0.683098223075208   0.970287585881840
   0.548589991269665   0.681992341119565   0.966015900758019
   0.539327416506329   0.680858831892629   0.961704489212519
   0.530034454923616   0.679690984462352   0.957350174804553
   0.520687275769168   0.678483658054281   0.952941911598536
   0.511294656809697   0.677229603122297   0.948466314194954
   0.501862938485935   0.675908131729894   0.943923414636781
   0.492368011695962   0.674526447585764   0.939296829570242
   0.482831966447479   0.673075056123589   0.934574344284250
   0.473239149938063   0.671529570913359   0.929751265778496
   0.463610199230141   0.669898490007484   0.924806441720999
   0.453931004095679   0.668151727643842   0.919735070002056
   0.444213105323239   0.666275367134404   0.914517836646940
   0.434439531629362   0.664271344957052   0.909136350577335
   0.424645424034694   0.662119682072216   0.903586196736133
   0.414818104701539   0.659790965435727   0.897845434027826
   0.404975135437596   0.657288711707752   0.891905334157116
   0.395137350306056   0.654578858744898   0.885750477317468
   0.385295806843827   0.651674341275651   0.879367836795064
   0.375492769346699   0.648535637522025   0.872757438852141
   0.365742092312658   0.645164483206235   0.865902855696845
   0.356058835711674   0.641552379196029   0.858800631349383
   0.346452875968170   0.637692175741870   0.851450634284268
   0.336982043615368   0.633573553839430   0.843855153951597
   0.327641676921377   0.629188774437778   0.836017496474579
   0.318486858990482   0.624551304502259   0.827936567870759
   0.309538810279774   0.619657024174185   0.819628494737425
   0.300784319230597   0.614497308007826   0.811108149155280
   0.292308970312550   0.609114899341690   0.802378662053047
   0.284097775420868   0.603484950811276   0.793470297612203
   0.276205047251963   0.597633563180424   0.784386083799233
   0.268594557202860   0.591579605671599   0.775143427605740
   0.261307839194872   0.585335410904858   0.765780254630640
   0.254368403344321   0.578907765261264   0.756295867188963
   0.247753311456416   0.572327969741807   0.746719332285321
   0.241464411753323   0.565596197461509   0.737066286528795
   0.235515333821420   0.558748023462952   0.727351375215958
   0.229842117637813   0.551801903789446   0.717599567099045
   0.224503292537290   0.544749964891370   0.707804983720319
   0.219484666062860   0.537628111591191   0.697997836402464
   0.214694145656626   0.530432601298457   0.688189511182314
   0.210171881801254   0.523192918023538   0.678377080974390
   0.205888751254590   0.515897186464339   0.668578266734789
   0.201770619008588   0.508597780553802   0.658786962762721
   0.197878189413329   0.501258086119358   0.649029870286136
   0.194172242569748   0.493902538729151   0.639287434358434
   0.190555557427611   0.486540663233484   0.629572402609992
   0.187111898421608   0.479181194884805   0.619898209439633
   0.183752219954346   0.471825775316424   0.610241029425681
   0.180499603332475   0.464473762656432   0.600622406471292
   0.177365458768960   0.457116704457888   0.591037068931245
   0.174263881362442   0.449787662520501   0.581483176325306
   0.171224492226131   0.442474124849551   0.571966419796719
   0.168241731961665   0.435172036244388   0.562486410829026
   0.165292469874621   0.427883736823476   0.553020860185600
   0.162438969199498   0.420607996924810   0.543603377385531
   0.159544923760329   0.413369955490036   0.534209908274014
   0.156738710285812   0.406146765849732   0.524855764184138
   0.153905471836684   0.398931967348718   0.515523850462542
   0.151122421034727   0.391757414093911   0.506230221257755
   0.148345823684060   0.384591213438764   0.496971638997036
   0.145640692370316   0.377461544406199   0.487750915710312
   0.142879029363855   0.370342755958532   0.478544204561926
   0.140138425630180   0.363256804887203   0.469388546600092
   0.137465759419886   0.356204245198409   0.460239029257644
   0.134776803823820   0.349161681115495   0.451146721046965
   0.132079089255033   0.342150343097023   0.442085015731710
   0.129401177071760   0.335172670167363   0.433041561038009
   0.126735298607131   0.328195155217729   0.424035796984704
   0.124089607703156   0.321259342323000   0.415070569655037
   0.121455552499882   0.314346760828489   0.406144198819964
   0.118899491634952   0.307460233022742   0.397234375036516
   0.116315522293628   0.300607646369181   0.388376346624572
   0.113730679890316   0.293780908869810   0.379545915001035
   0.111187322960097   0.286980435813756   0.370747899573980
   0.108613189196105   0.280216902117547   0.362003706390306
   0.106159461712125   0.273496733899749   0.353280223543024
   0.103669678641444   0.266775983189304   0.344594368973379
   0.101182715837138   0.260108138386508   0.335952338103771
   0.098776424280365   0.253467179652103   0.327342165603349
   0.096347187736976   0.246849873386890   0.318782541544171
   0.094059455070407   0.240263704793932   0.310267077181388
   0.091788429944862   0.233727151444506   0.301758164056688
   0.089505899654058   0.227245397597824   0.293318017701887
   0.087340959592987   0.220799858732753   0.284913521418822
   0.085141598712121   0.214360396682229   0.276575563119527
   0.083069328213692   0.207981371753857   0.268248746258313
   0.081097764311541   0.201631123770808   0.259992161375360
   0.079129555994594   0.195360642022294   0.251781368350159
   0.077286105557682   0.189136223691836   0.243588653311962
   0.075570930295240   0.182943098387141   0.235501553767662
   0.073993294240768   0.176834986321833   0.227433990604534
   0.072409561929675   0.170785242784600   0.219432849335413
   0.071044734047482   0.164795465963924   0.211500069262636
   0.069767488452765   0.158900942278471   0.203627846104966
   0.068617597848449   0.153040439540086   0.195818453180052
   0.067560086175244   0.147318614759101   0.188124282120339
   0.066664907363901   0.141671474143823   0.180452312805501
   0.065923146629894   0.136075912997472   0.172916639868198
   0.065339116001440   0.130695327541620   0.165458230004290
   0.064910610405507   0.125348529940773   0.158169305926339
   0.064636068656793   0.120131669652011   0.150946411638067
   0.064516805173459   0.115070070440447   0.143889307342939
   0.064554258321866   0.110222406262980   0.136957072743348
   0.064748700601933   0.105427389921344   0.130229515160652
   0.065099893677733   0.100849256515667   0.123568574094619
   0.065383232317308   0.096468706332455   0.117169970447005
   0.065573884931351   0.092338377698673   0.111007916137588
   0.065892424949717   0.088201049034942   0.104981515690442
   0.066388292530184   0.084133959263690   0.099288204982983
   0.067107980281491   0.080050571292529   0.093829191263915
   0.068193206368960   0.076098826918044   0.088469707114493
   0.069719604844736   0.072282547595753   0.083025047551370
   0.071638701360626   0.068654481840805   0.077543679571719
   0.073977669980836   0.065057925311877   0.072110379161166
   0.076595752700913   0.061657123922414   0.066650836617214
   0.079636861043310   0.058549764875825   0.061132595108191
   0.082963478953414   0.055665663838214   0.055744631693326
   0.086536918643557   0.052996509293590   0.050335950356631
   0.090314948056186   0.050698927177150   0.045040247744044
   0.094260009908442   0.048752644317606   0.039772837489913
   0.098319404484925   0.047041246032052   0.034682721609814
   0.102458458840457   0.045624346589079   0.030074378228874
   0.106732194382749   0.044704962610938   0.026012087018180
   0.110985819280674   0.043972242973693   0.022379155555177
   0.115244595359118   0.043596138378824   0.019150379753729
   0.119546992429717   0.043567367363913   0.016298717211121
   0.123811625438728   0.043861107834357   0.013796657210681
   0.128104919874751   0.044458505447597   0.011588366229824
   0.132315250748474   0.045228607847713   0.009531491955062
   0.136451268693273   0.046163583471276   0.007894698512019
   0.140634550445431   0.047374423435138   0.006501999967266
   0.144883554398166   0.048634353260985   0.005326598910555
   0.149229608504520   0.049835691831312   0.004345500897739
   0.153685205927126   0.050996726780490   0.003537353860908
   0.158308911954424   0.052130050428052   0.002882358604242
   0.163013897571481   0.053218120509540   0.002362788816829
   0.167811418702717   0.054239908274657   0.001962897927273
   0.172735589968639   0.055171585606118   0.001668979150874
   0.177801401902415   0.056017935343705   0.001469244614103
   0.182863226411205   0.056819797004328   0.001340070326674
   0.188057759998889   0.057573544329720   0.001261683281071
   0.193233334145248   0.058514147400546   0.001226107907666
   0.198463440853382   0.059549790544833   0.001227108213924
   0.203778059919658   0.060500916318210   0.001260104861026
   0.209092161387544   0.061486378830272   0.001322098263497
   0.214469660632555   0.062709830830326   0.001411613992750
   0.219897040939924   0.063822769842802   0.001528678228985
   0.225345306062820   0.065027189051630   0.001674786365518
   0.230856164004311   0.066297066969063   0.001852913057428
   0.236421976004794   0.067644974999143   0.002067531987231
   0.242015996168867   0.069091849239937   0.002324650016357
   0.247680863281389   0.070457574952701   0.002631853923759
   0.253390279033368   0.071986125760070   0.002998359050971
   0.259176003627959   0.073639565991067   0.003435049054193
   0.264997418577139   0.075236715872047   0.003954503555257
   0.270933615791862   0.076965469098363   0.004571019280766
   0.276928293348030   0.078822055046408   0.005300642168531
   0.283016615569472   0.080819125461820   0.006160777595218
   0.289196380039127   0.082879488938685   0.007171313633082
   0.295466489249202   0.085074650020452   0.008349364241717
   0.301857512455370   0.087459900653346   0.009725834770352
   0.308386553788043   0.089912034225032   0.011455189140066
   0.315024220733866   0.092530444828619   0.013324222511574
   0.321805792416885   0.095391780322922   0.015413349515501
   0.328738226613899   0.098395699615599   0.017779613876340
   0.335804725250216   0.101579626050700   0.020448812547420
   0.343035578537844   0.104976608872490   0.023440470671093
   0.350413371411688   0.108639733482299   0.026771417281161
   0.357946792999011   0.112563505384369   0.030455612891965
   0.365629431320574   0.116657721897659   0.034571478537312
   0.373470184391758   0.120971400791468   0.039115104329900
   0.381463489714057   0.125606306049455   0.043693458217647
   0.389582727987436   0.130457185405917   0.048470546671152
   0.397845325865380   0.135473661499860   0.053136485942891
   0.406220070316748   0.140795490181723   0.057848223431880
   0.414689593622266   0.146274050919423   0.062714942676724
   0.423228809817050   0.151979000751161   0.067685328406644
   0.431837387935583   0.157906098126718   0.073044005189238
   0.440443765141629   0.164028394727591   0.078619963416895
   0.449085109585644   0.170268567285753   0.084644045401459
   0.457704221270954   0.176665744157233   0.090869208923978
   0.466314233326683   0.183213385709356   0.097335322711731
   0.474899934887218   0.189887721803328   0.104064370530962
   0.483420334727805   0.196677353639129   0.111038886144133
   0.491910219101946   0.203516342331652   0.118189944017367
   0.500322467589709   0.210432881942613   0.125500607019583
   0.508689944680727   0.217424740496503   0.132983204864123
   0.516977436657090   0.224432258953814   0.140623017716760
   0.525196944064706   0.231543220887728   0.148349145485003
   0.533349405074302   0.238623948621766   0.156261425704070
   0.541439728760956   0.245754861098734   0.164233163929993
   0.549481385157313   0.252923309749094   0.172264632101076
   0.557462235586830   0.260091255311763   0.180403450101407
   0.565377864503924   0.267255493657086   0.188639983460229
   0.573271567094890   0.274460957160323   0.196923537190093
   0.581111702020348   0.281673267223689   0.205236751128576
   0.588920284730395   0.288894176493035   0.213624894712203
   0.596715922012575   0.296113919678316   0.222053677684160
   0.604483907134438   0.303345054570961   0.230529214159457
   0.612227562504717   0.310617081394037   0.239051658684935
   0.619976499426722   0.317866584966397   0.247617825808016
   0.627707522721071   0.325132444209036   0.256188566655987
   0.635437682780529   0.332443319742680   0.264814825262708
   0.643173313831657   0.339745143708105   0.273489658927923
   0.650916544772005   0.347064327412587   0.282179444471648
   0.658661244750340   0.354395083324666   0.290886839801170
   0.666419148176456   0.361750830851713   0.299640195889043
   0.674193542339132   0.369121161596962   0.308415261669479
   0.681975159705591   0.376517800329987   0.317219494709475
   0.689782883354772   0.383919711959203   0.326042683251000
   0.697595950238028   0.391354091346015   0.334929100177124
   0.705434020500552   0.398794354800745   0.343796432232734
   0.713287529171566   0.406271318512252   0.352720169402329
   0.721158399111098   0.413756541539564   0.361661645402397
   0.729053937991222   0.421259038971929   0.370617708085399
   0.736968123279006   0.428796182537331   0.379615665286379
   0.744900163790974   0.436349440756765   0.388638585470705
   0.752850632679761   0.443922517823723   0.397680219904845
   0.760830746759342   0.451511840853582   0.406746994413494
   0.768820933585628   0.459124171928489   0.415838340818323
   0.776843959648820   0.466755590285943   0.424962167372892
   0.784879069948421   0.474407289930287   0.434092350739796
   0.792934743117149   0.482079761706520   0.443268521442554
   0.801008919401297   0.489762683563748   0.452464545167882
   0.809109539346902   0.497486200543524   0.461671764697348
   0.817222496508499   0.505206596156607   0.470909949776913
   0.825357581924668   0.512962026385585   0.480170041019244
   0.833517142441286   0.520731812703657   0.489445241361892
   0.841691528547957   0.528527219171093   0.498762560496600
   0.849884744125370   0.536335338304328   0.508096269701274
   0.858092473595397   0.544161295052675   0.517448268783098
   0.866323607651548   0.552013287595526   0.526825305619729
   0.874568238560486   0.559878584769012   0.536218351371394
   0.882829311195766   0.567760793702451   0.545642880837070
   0.891109753282857   0.575669692990002   0.555081847798834
   0.899406611694157   0.583584539953731   0.564550094262548
   0.907715789416051   0.591530232263565   0.574038076213087
   0.916031052727207   0.599491743413512   0.583552009699197
   0.924368141613458   0.607472677348361   0.593094672489828
   0.932714370401054   0.615459774950916   0.602649135095062
   0.941076352651578   0.623482950935375   0.612228909050748
   0.949447127260928   0.631512178418110   0.621831796243571
   0.957831669900679   0.639562785400449   0.631467442162916
   0.966219008145579   0.647627708291168   0.641112870139231
   0.974618983361163   0.655717843683647   0.650792288057003
   0.983030143194057   0.663822516206390   0.660486827571796
   0.991448163387329   0.671938707697227   0.670216093116336
   0.999873421230062   0.680071528567242   0.679950135021200
   ];

P = size(values,1);
map = interp1(1:size(values,1), values, linspace(1,P,m), 'linear');
