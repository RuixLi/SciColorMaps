function map = cividis(m)
%   CIVIDIS a colour map adopted from matplotlib
%   cividis(M) returns an M-by-3 matrix containing a colormap. 
%   written by Ruix.Li in Jan, 2021

% USAGE:
% colormap(cividis(128))
% colormap cividis

if nargin < 1
   f = get(groot,'CurrentFigure');
   if isempty(f)
      m = size(get(groot,'DefaultFigureColormap'),1);
   else
      m = size(f.Colormap,1);
   end
end

values = [
                   0   0.135112000000000   0.304751000000000
                   0   0.138068000000000   0.311105000000000
                   0   0.141013000000000   0.317579000000000
                   0   0.143951000000000   0.323982000000000
                   0   0.146877000000000   0.330479000000000
                   0   0.149791000000000   0.337065000000000
                   0   0.152673000000000   0.343704000000000
                   0   0.155377000000000   0.350500000000000
                   0   0.157932000000000   0.357521000000000
                   0   0.160495000000000   0.364534000000000
                   0   0.163058000000000   0.371608000000000
                   0   0.165621000000000   0.378769000000000
                   0   0.168204000000000   0.385902000000000
                   0   0.170800000000000   0.393100000000000
                   0   0.173420000000000   0.400353000000000
                   0   0.176082000000000   0.407577000000000
                   0   0.178802000000000   0.414764000000000
                   0   0.181610000000000   0.421859000000000
                   0   0.184550000000000   0.428802000000000
                   0   0.186915000000000   0.435532000000000
                   0   0.188769000000000   0.439563000000000
                   0   0.190950000000000   0.441085000000000
                   0   0.193366000000000   0.441561000000000
   0.003602000000000   0.195911000000000   0.441564000000000
   0.017852000000000   0.198528000000000   0.441248000000000
   0.032110000000000   0.201199000000000   0.440785000000000
   0.046205000000000   0.203903000000000   0.440196000000000
   0.058378000000000   0.206629000000000   0.439531000000000
   0.068968000000000   0.209372000000000   0.438863000000000
   0.078624000000000   0.212122000000000   0.438105000000000
   0.087465000000000   0.214879000000000   0.437342000000000
   0.095645000000000   0.217643000000000   0.436593000000000
   0.103401000000000   0.220406000000000   0.435790000000000
   0.110658000000000   0.223170000000000   0.435067000000000
   0.117612000000000   0.225935000000000   0.434308000000000
   0.124291000000000   0.228697000000000   0.433547000000000
   0.130669000000000   0.231458000000000   0.432840000000000
   0.136830000000000   0.234216000000000   0.432148000000000
   0.142852000000000   0.236972000000000   0.431404000000000
   0.148638000000000   0.239724000000000   0.430752000000000
   0.154261000000000   0.242475000000000   0.430120000000000
   0.159733000000000   0.245221000000000   0.429528000000000
   0.165113000000000   0.247965000000000   0.428908000000000
   0.170362000000000   0.250707000000000   0.428325000000000
   0.175490000000000   0.253444000000000   0.427790000000000
   0.180503000000000   0.256180000000000   0.427299000000000
   0.185453000000000   0.258914000000000   0.426788000000000
   0.190303000000000   0.261644000000000   0.426329000000000
   0.195057000000000   0.264372000000000   0.425924000000000
   0.199764000000000   0.267099000000000   0.425497000000000
   0.204385000000000   0.269823000000000   0.425126000000000
   0.208926000000000   0.272546000000000   0.424809000000000
   0.213431000000000   0.275266000000000   0.424480000000000
   0.217863000000000   0.277985000000000   0.424206000000000
   0.222264000000000   0.280702000000000   0.423914000000000
   0.226598000000000   0.283419000000000   0.423678000000000
   0.230871000000000   0.286134000000000   0.423498000000000
   0.235120000000000   0.288848000000000   0.423304000000000
   0.239312000000000   0.291562000000000   0.423167000000000
   0.243485000000000   0.294274000000000   0.423014000000000
   0.247605000000000   0.296986000000000   0.422917000000000
   0.251675000000000   0.299698000000000   0.422873000000000
   0.255731000000000   0.302409000000000   0.422814000000000
   0.259740000000000   0.305120000000000   0.422810000000000
   0.263738000000000   0.307831000000000   0.422789000000000
   0.267693000000000   0.310542000000000   0.422821000000000
   0.271639000000000   0.313253000000000   0.422837000000000
   0.275513000000000   0.315965000000000   0.422979000000000
   0.279411000000000   0.318677000000000   0.423031000000000
   0.283240000000000   0.321390000000000   0.423211000000000
   0.287065000000000   0.324103000000000   0.423373000000000
   0.290884000000000   0.326816000000000   0.423517000000000
   0.294669000000000   0.329531000000000   0.423716000000000
   0.298421000000000   0.332247000000000   0.423973000000000
   0.302169000000000   0.334963000000000   0.424213000000000
   0.305886000000000   0.337681000000000   0.424512000000000
   0.309601000000000   0.340399000000000   0.424790000000000
   0.313287000000000   0.343120000000000   0.425120000000000
   0.316941000000000   0.345842000000000   0.425512000000000
   0.320595000000000   0.348565000000000   0.425889000000000
   0.324250000000000   0.351289000000000   0.426250000000000
   0.327875000000000   0.354016000000000   0.426670000000000
   0.331474000000000   0.356744000000000   0.427144000000000
   0.335073000000000   0.359474000000000   0.427605000000000
   0.338673000000000   0.362206000000000   0.428053000000000
   0.342246000000000   0.364939000000000   0.428559000000000
   0.345793000000000   0.367676000000000   0.429127000000000
   0.349341000000000   0.370414000000000   0.429685000000000
   0.352892000000000   0.373153000000000   0.430226000000000
   0.356418000000000   0.375896000000000   0.430823000000000
   0.359916000000000   0.378641000000000   0.431501000000000
   0.363446000000000   0.381388000000000   0.432075000000000
   0.366923000000000   0.384139000000000   0.432796000000000
   0.370430000000000   0.386890000000000   0.433428000000000
   0.373884000000000   0.389646000000000   0.434209000000000
   0.377371000000000   0.392404000000000   0.434890000000000
   0.380830000000000   0.395164000000000   0.435653000000000
   0.384268000000000   0.397928000000000   0.436475000000000
   0.387705000000000   0.400694000000000   0.437305000000000
   0.391151000000000   0.403464000000000   0.438096000000000
   0.394568000000000   0.406236000000000   0.438986000000000
   0.397991000000000   0.409011000000000   0.439848000000000
   0.401418000000000   0.411790000000000   0.440708000000000
   0.404820000000000   0.414572000000000   0.441642000000000
   0.408226000000000   0.417357000000000   0.442570000000000
   0.411607000000000   0.420145000000000   0.443577000000000
   0.414992000000000   0.422937000000000   0.444578000000000
   0.418383000000000   0.425733000000000   0.445560000000000
   0.421748000000000   0.428531000000000   0.446640000000000
   0.425120000000000   0.431334000000000   0.447692000000000
   0.428462000000000   0.434140000000000   0.448864000000000
   0.431817000000000   0.436950000000000   0.449982000000000
   0.435168000000000   0.439763000000000   0.451134000000000
   0.438504000000000   0.442580000000000   0.452341000000000
   0.441810000000000   0.445402000000000   0.453659000000000
   0.445148000000000   0.448226000000000   0.454885000000000
   0.448447000000000   0.451053000000000   0.456264000000000
   0.451759000000000   0.453887000000000   0.457582000000000
   0.455072000000000   0.456718000000000   0.458976000000000
   0.458366000000000   0.459552000000000   0.460457000000000
   0.461616000000000   0.462405000000000   0.461969000000000
   0.464947000000000   0.465241000000000   0.463395000000000
   0.468254000000000   0.468083000000000   0.464908000000000
   0.471501000000000   0.470960000000000   0.466357000000000
   0.474812000000000   0.473832000000000   0.467681000000000
   0.478186000000000   0.476699000000000   0.468845000000000
   0.481622000000000   0.479573000000000   0.469767000000000
   0.485141000000000   0.482451000000000   0.470384000000000
   0.488697000000000   0.485318000000000   0.471008000000000
   0.492278000000000   0.488198000000000   0.471453000000000
   0.495913000000000   0.491076000000000   0.471751000000000
   0.499552000000000   0.493960000000000   0.472032000000000
   0.503185000000000   0.496851000000000   0.472305000000000
   0.506866000000000   0.499743000000000   0.472432000000000
   0.510540000000000   0.502643000000000   0.472550000000000
   0.514226000000000   0.505546000000000   0.472640000000000
   0.517920000000000   0.508454000000000   0.472707000000000
   0.521643000000000   0.511367000000000   0.472639000000000
   0.525348000000000   0.514285000000000   0.472660000000000
   0.529086000000000   0.517207000000000   0.472543000000000
   0.532829000000000   0.520135000000000   0.472401000000000
   0.536553000000000   0.523067000000000   0.472352000000000
   0.540307000000000   0.526005000000000   0.472163000000000
   0.544069000000000   0.528948000000000   0.471947000000000
   0.547840000000000   0.531895000000000   0.471704000000000
   0.551612000000000   0.534849000000000   0.471439000000000
   0.555393000000000   0.537807000000000   0.471147000000000
   0.559181000000000   0.540771000000000   0.470829000000000
   0.562972000000000   0.543741000000000   0.470488000000000
   0.566802000000000   0.546715000000000   0.469988000000000
   0.570607000000000   0.549695000000000   0.469593000000000
   0.574417000000000   0.552682000000000   0.469172000000000
   0.578236000000000   0.555673000000000   0.468724000000000
   0.582087000000000   0.558670000000000   0.468118000000000
   0.585916000000000   0.561674000000000   0.467618000000000
   0.589753000000000   0.564682000000000   0.467090000000000
   0.593622000000000   0.567697000000000   0.466401000000000
   0.597469000000000   0.570718000000000   0.465821000000000
   0.601354000000000   0.573743000000000   0.465074000000000
   0.605211000000000   0.576777000000000   0.464441000000000
   0.609105000000000   0.579816000000000   0.463638000000000
   0.612977000000000   0.582861000000000   0.462950000000000
   0.616852000000000   0.585913000000000   0.462237000000000
   0.620765000000000   0.588970000000000   0.461351000000000
   0.624654000000000   0.592034000000000   0.460583000000000
   0.628576000000000   0.595104000000000   0.459641000000000
   0.632506000000000   0.598180000000000   0.458668000000000
   0.636412000000000   0.601264000000000   0.457818000000000
   0.640352000000000   0.604354000000000   0.456791000000000
   0.644270000000000   0.607450000000000   0.455886000000000
   0.648222000000000   0.610553000000000   0.454801000000000
   0.652178000000000   0.613664000000000   0.453689000000000
   0.656114000000000   0.616780000000000   0.452702000000000
   0.660082000000000   0.619904000000000   0.451534000000000
   0.664055000000000   0.623034000000000   0.450338000000000
   0.668008000000000   0.626171000000000   0.449270000000000
   0.671991000000000   0.629316000000000   0.448018000000000
   0.675981000000000   0.632468000000000   0.446736000000000
   0.679979000000000   0.635626000000000   0.445424000000000
   0.683950000000000   0.638793000000000   0.444251000000000
   0.687957000000000   0.641966000000000   0.442886000000000
   0.691971000000000   0.645145000000000   0.441491000000000
   0.695985000000000   0.648334000000000   0.440072000000000
   0.700008000000000   0.651529000000000   0.438624000000000
   0.704037000000000   0.654731000000000   0.437147000000000
   0.708067000000000   0.657942000000000   0.435647000000000
   0.712105000000000   0.661160000000000   0.434117000000000
   0.716177000000000   0.664384000000000   0.432386000000000
   0.720222000000000   0.667618000000000   0.430805000000000
   0.724274000000000   0.670859000000000   0.429194000000000
   0.728334000000000   0.674107000000000   0.427554000000000
   0.732422000000000   0.677364000000000   0.425717000000000
   0.736488000000000   0.680629000000000   0.424028000000000
   0.740589000000000   0.683900000000000   0.422131000000000
   0.744664000000000   0.687181000000000   0.420393000000000
   0.748772000000000   0.690470000000000   0.418448000000000
   0.752886000000000   0.693766000000000   0.416472000000000
   0.756975000000000   0.697071000000000   0.414659000000000
   0.761096000000000   0.700384000000000   0.412638000000000
   0.765223000000000   0.703705000000000   0.410587000000000
   0.769353000000000   0.707035000000000   0.408516000000000
   0.773486000000000   0.710373000000000   0.406422000000000
   0.777651000000000   0.713719000000000   0.404112000000000
   0.781795000000000   0.717074000000000   0.401966000000000
   0.785965000000000   0.720438000000000   0.399613000000000
   0.790116000000000   0.723810000000000   0.397423000000000
   0.794298000000000   0.727190000000000   0.395016000000000
   0.798480000000000   0.730580000000000   0.392597000000000
   0.802667000000000   0.733978000000000   0.390153000000000
   0.806859000000000   0.737385000000000   0.387684000000000
   0.811054000000000   0.740801000000000   0.385198000000000
   0.815274000000000   0.744226000000000   0.382504000000000
   0.819499000000000   0.747659000000000   0.379785000000000
   0.823729000000000   0.751101000000000   0.377043000000000
   0.827959000000000   0.754553000000000   0.374292000000000
   0.832192000000000   0.758014000000000   0.371529000000000
   0.836429000000000   0.761483000000000   0.368747000000000
   0.840693000000000   0.764962000000000   0.365746000000000
   0.844957000000000   0.768450000000000   0.362741000000000
   0.849223000000000   0.771947000000000   0.359729000000000
   0.853515000000000   0.775454000000000   0.356500000000000
   0.857809000000000   0.778969000000000   0.353259000000000
   0.862105000000000   0.782494000000000   0.350011000000000
   0.866421000000000   0.786028000000000   0.346571000000000
   0.870717000000000   0.789572000000000   0.343333000000000
   0.875057000000000   0.793125000000000   0.339685000000000
   0.879378000000000   0.796687000000000   0.336241000000000
   0.883720000000000   0.800258000000000   0.332599000000000
   0.888081000000000   0.803839000000000   0.328770000000000
   0.892440000000000   0.807430000000000   0.324968000000000
   0.896818000000000   0.811030000000000   0.320982000000000
   0.901195000000000   0.814639000000000   0.317021000000000
   0.905589000000000   0.818257000000000   0.312889000000000
   0.910000000000000   0.821885000000000   0.308594000000000
   0.914407000000000   0.825522000000000   0.304348000000000
   0.918828000000000   0.829168000000000   0.299960000000000
   0.923279000000000   0.832822000000000   0.295244000000000
   0.927724000000000   0.836486000000000   0.290611000000000
   0.932180000000000   0.840159000000000   0.285880000000000
   0.936660000000000   0.843841000000000   0.280876000000000
   0.941147000000000   0.847530000000000   0.275815000000000
   0.945654000000000   0.851228000000000   0.270532000000000
   0.950178000000000   0.854933000000000   0.265085000000000
   0.954725000000000   0.858646000000000   0.259365000000000
   0.959284000000000   0.862365000000000   0.253563000000000
   0.963872000000000   0.866089000000000   0.247445000000000
   0.968469000000000   0.869819000000000   0.241310000000000
   0.973114000000000   0.873550000000000   0.234677000000000
   0.977780000000000   0.877281000000000   0.227954000000000
   0.982497000000000   0.881008000000000   0.220878000000000
   0.987293000000000   0.884718000000000   0.213336000000000
   0.992218000000000   0.888385000000000   0.205468000000000
   0.994847000000000   0.892954000000000   0.203445000000000
   0.995249000000000   0.898384000000000   0.207561000000000
   0.995503000000000   0.903866000000000   0.212370000000000
   0.995737000000000   0.909344000000000   0.217772000000000
   ];

P = size(values,1);
map = interp1(1:size(values,1), values, linspace(1,P,m), 'linear');
